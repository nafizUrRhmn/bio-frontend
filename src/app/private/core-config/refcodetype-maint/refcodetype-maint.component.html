<mat-stepper [linear]="isLinear" #stepper>
  <mat-step [stepControl]="refCodeTypeForm" label="RCT Maintainance">
    <form [formGroup]="refCodeTypeForm">
      <div class="d-flex flex-column m-2 me-5">
        <div class="pt-1 w-50 row mt-5">
          <label for="funcCode" class="form-label text-muted fw-bold col-sm-6 col-md-6 col-lg-4">Function Code *</label>
          <div class="col-sm-6 col-md-6 col-lg-8">
            <select id="funcCode"
                    class="form-select form-select-sm"
                    aria-label=".form-select-lg example"
                    formControlName="funcCode"
                    (change)="onChangeFuncCode($event)"
                    [ngClass]="{ 'is-invalid': isOnNextClick && funcCode.errors }" >
              <option selected > </option>
              <option value="I">I-Inquiry</option>
              <option value="A">A-Add</option>
              <option value="D">D-Delete</option>
              <option value="U">U-Undelete</option>
              <option value="M">M-Modification</option>
              <option value="V">V-Verification</option>
              <option value="X">X-Cancel</option>
              <option value="C">C-Copy</option>
            </select>
            <div class="d-flex flex-row">
              <div *ngIf="isOnNextClick && funcCode.invalid" class="error-feedback">
                <div *ngIf="funcCode.errors?.['required']">function code must be selected</div>
              </div>
            </div>
          </div>
        </div>
        <div class="pt-4 w-50 row">
          <label for="refCodeType" class="form-label text-muted fw-bold col-sm-6 col-md-6 col-lg-4">
            Reference Type *
          </label>
          <div class="col-sm-6 col-md-6 col-lg-8">
            <div class="d-flex flex-row">
              <input
                type="text"
                class="form-control"
                id="refCodeType"
                formControlName="refCodeType"
                maxlength="2"
                [ngClass]="{ 'is-invalid': isOnNextClick && refCodeType.errors }"
              />
                <button type="button" class="btn btn-outline-primary ms-5"
                      (click)="onSearch(funcCode.value,refCodeType.value,'refCodeType')">
                Search
              </button>
              <label class="form-label text-muted">{{refCodeTypeDesc}}</label>
            </div>
            <div class="d-flex flex-row">
              <div *ngIf="isOnNextClick && refCodeType.invalid" class="error-feedback">
                <div *ngIf="refCodeType.errors?.['required']">Reference Type must be entered</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- NEXT BUTTON -->
      <div class="mt-4 d-flex justify-content-end">
        <button type="button" mat-button class="btn btn-secondary mt-5" (click)="onNext()">
          <div class="d-flex align-items-center justify-content-center gap-1">
            Next
            <i class="ti ti-arrow-right fs-3"></i>
          </div>

        </button>
      </div>
    </form>
  </mat-step>


  <!-- SECOND STEP -->
  <mat-step [stepControl]="refDetailForm" label="RCT Details" class="prevent-scroll">
    <div class="row text-center pb-5">
      <div class="col-sm-6 col-md-4 col-lg-4">
        <span class="text-muted fw-bold mt-2">Function Code - {{ funcCode.value }}</span>
      </div>
      <div class="col-sm-6 col-md-4 col-lg-4">
        <span class="text-muted fw-bold mt-2">Reference Type - {{ refCodeType.value }}</span>
      </div>
    </div>
    <form [formGroup]="refDetailForm">
      <div class="m-2 w-50">
        <div class="row" *ngIf="isVisibleNewRefType">
          <div class="col-sm-6 col-md-4 col-lg-4">
            <label class="text-muted fw-bold mt-2">Reference Type New</label>
          </div>
          <div class="col-sm-6 col-md-8 col-lg-8">
            <input type="text" class="form-control" maxlength="2" formControlName="newRefCodeType">
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-sm-6 col-md-4 col-lg-4">
            <label class="text-muted fw-bold mt-2">Reference Type Desc *</label>
          </div>
          <div class="col-sm-6 col-md-8 col-lg-8">
            <input type="text"
                   class="form-control"
                   maxlength="100"
                   formControlName="refDescription"
                   [ngClass]="{ 'is-invalid': isOnNextClick && funcCode.errors }" />
          </div>
        </div>

        <div class="row mt-3">
          <div class="col-sm-6 col-md-4 col-lg-4">
            <label class="text-muted fw-bold">Length *</label>
          </div>
          <div class="col-sm-6 col-md-8 col-lg-8">
            <input type="number"
                   class="form-control right-input"
                   onKeyPress="if(this.value.length==2) return false;"
                   formControlName="refLength">
          </div>
        </div>


        <div class="row mt-3">
          <div class="col-sm-6 col-md-4 col-lg-4">
            <label class="text-muted fw-bold">Dependent Flg*</label>
          </div>
          <div class="col-sm-6 col-md-8 col-lg-8 d-flex justify-content-around">
            <div class="form-check">
              <input class="form-check-input"
                     type="radio"
                     id="dependentFlgYes"
                     value="Y"
                     formControlName="dependentFlg"
                     (change)="onChangeDepFlg($event)">
              <label class="form-check-label" for="dependentFlgYes">
                YES
              </label>
            </div>
            <div class="form-check">
              <input class="form-check-input"
                     type="radio"
                     id="dependentFlgNo"
                     value="N"
                     formControlName="dependentFlg"
                     (change)="onChangeDepFlg($event)">
              <label class="form-check-label" for="dependentFlgNo">
                NO
              </label>
            </div>
          </div>
        </div>

        <div class="row mt-3" *ngIf="isVisibleDepFlds">
          <div class="col-sm-6 col-md-4 col-lg-4">
            <label class="text-muted fw-bold">Dep Ref Type</label>
          </div>
          <div class="col-sm-6 col-md-4 col-lg-4">
            <input type="text" class="form-control"
                   maxlength="2"
                   formControlName="depRefType">
          </div>
          <div class="col-sm-6 col-md-4 col-lg-4 " *ngIf="isVisibleDepSrchBtn">
            <button type="button" class="btn btn-outline-primary"
                    (click)="onSearch('I',depRefType.value,'depRefType')">
              Search
            </button>
          </div>



        </div>
        <div class="row mt-3 d-flex justify-content-center align-items-center" *ngIf="isVisibleDepFlds">
          <div class="col-sm-6 col-md-4 col-lg-4">
            <label class="text-muted fw-bold">Dep Ref Type Description *</label>
          </div>
          <div class="col-sm-6 col-md-8 col-lg-8">
            <input type="text"
                   class="form-control"
                   formControlName="depRefCodeTypeDesc">
          </div>
        </div>
      </div>

      <!-- BOTTOM BUTTONS -->
      <div class="d-flex flex-row justify-content-end">
        <div>
          <button type="button" mat-button matStepperPrevious class="btn btn-danger"
                  (click)="onCancel()">
            Cancel
          </button>
        </div>

        <div class="ms-2">
          <button type="button" class="btn btn-primary"
                  *ngIf="isVisibleSubmitBtn"
                  (click)="onSubmit()">
            Submit
          </button>
        </div>
      </div>
    </form>
  </mat-step>
</mat-stepper>
